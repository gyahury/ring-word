import"./style-B_l4csH6.js";document.addEventListener("DOMContentLoaded",()=>{const p=new URLSearchParams(window.location.search),L=p.get("nickname"),X=p.get("page"),I=document.getElementById("word"),Y=document.getElementById("curWordCount"),w=document.getElementById("allWordCount"),J=document.getElementById("prevButton"),T=document.getElementById("flipButton"),z=document.getElementById("nextButton"),U=document.getElementById("searchButton"),j=document.getElementById("toggleMenuButton"),m=document.getElementById("toggleDrawButton"),i=document.getElementById("controlAutoProgressButton"),R=document.getElementById("shuffleButton"),$=document.getElementById("excludeWordButton"),g=document.getElementById("checkWordButton"),H=document.getElementById("backButton"),c=document.getElementById("canvas"),l=c.getContext("2d");let r=[],o=0,s=!0,h=!1,E=0,y=0,a;d(),N(),fetch("https://gyahury.github.io/japanese-word/"+L+"/words.json").then(e=>e.json()).then(e=>{localStorage.getItem("lastKey")&&G(e.words),r=e.words.filter(n=>n.type===X),w.textContent=r.length,r.length>0?u(o):(alert("invalid access"),ce())}).catch(e=>alert("error occurred : "+e)),window.addEventListener("resize",d),document.addEventListener("keydown",function(e){e.key==="ArrowLeft"?(d(),W()):e.key==="ArrowRight"?(d(),k()):(e.key==="ArrowUp"||e.key==="ArrowDown")&&B()}),J.addEventListener("click",()=>{d(),W()}),z.addEventListener("click",()=>{d(),k()}),T.addEventListener("click",()=>{B()}),U.addEventListener("click",()=>{const t=`https://ja.dict.naver.com/?m=mobile#/search?query=${r[o].word}`;window.open(t,"_blank")}),j.addEventListener("click",S),m.addEventListener("click",ne),i.addEventListener("click",oe),$.addEventListener("click",q),g.addEventListener("click",C),R.addEventListener("click",()=>{confirm("would you like to shuffle?")&&(o=0,s=!0,d(),Q(r),u(o),S())}),H.addEventListener("click",()=>{confirm("are you sure you want to go back? unsaved changes will be lost")&&x()});function u(e){const t=r[e];t.type=="Checked"&&_(),s?I.innerHTML=`${t.word}`:I.innerHTML=`${t.furigana}<div style='font-size: clamp(0.7rem, 6vw, 2rem);'>${t.meaning}</div>`,Y.textContent=e+1}function _(){g.id="uncheckWordButton",g.textContent="Uncheck Word",g.removeEventListener("click",C),document.getElementById("uncheckWordButton").addEventListener("click",F)}function q(){confirm("would you like to exclude this word? it will be temporarily excluded")&&(r=r.filter((e,t)=>t!==o),r.length==0?(alert("congratulations. there are no more words to memorize"),x()):(o>=r.length&&(o=0),s=!0,u(o)),w.textContent=r.length)}function C(){let e=localStorage.getItem("lastKey");e=e?parseInt(e):-1;const t=e+1,n=JSON.parse(JSON.stringify(r[o]));n.type="Checked",n.key=t,V(n,e)?confirm("this word already exists. would you like to check it?")&&(localStorage.setItem(t,JSON.stringify(n)),localStorage.setItem("lastKey",t.toString()),alert("successfully added")):confirm("would you like to add it?")&&(localStorage.setItem(t,JSON.stringify(n)),localStorage.setItem("lastKey",t.toString()),alert("successfully added"))}function F(){confirm("would you like to uncheck this word?")&&(localStorage.removeItem(r[o].key),r=r.filter((e,t)=>t!==o),r.length==0?(alert("congratulations. there are no more words to memorize"),x()):(o>=r.length&&(o=0),s=!0,u(o)),w.textContent=r.length)}function G(e){let t=localStorage.getItem("lastKey");for(let n=0;n<t+1;n++){const f=JSON.parse(localStorage.getItem(n));f&&e.push(f)}return e}function V(e,t){for(let n=0;n<t+1;n++){const f=JSON.parse(localStorage.getItem(n));if(f&&f.word===e.word)return!0}return!1}function W(){o>0?(o--,s=!0,u(o)):o==0&&(o=r.length-1,s=!0,u(o))}function k(){o<r.length-1?(o++,s=!0,u(o)):o==r.length-1&&(o=0,s=!0,u(o))}function B(){s=!s,u(o)}function S(){const e=document.getElementById("toggleMenuButton"),t=e.parentNode.nextElementSibling,n=e.getAttribute("aria-expanded")==="true";e.setAttribute("aria-expanded",!n),t.style.display=n?"none":"block"}function Q(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}}function Z(e,t){l.beginPath(),l.moveTo(E,y),l.lineTo(e,t),l.lineWidth=3,l.lineCap="round",l.strokeStyle="RGBA(169, 169, 169, 1)",l.stroke()}function A(e){E=e.offsetX,y=e.offsetY,h=!0}function O(e){if(!h)return;let t=e.offsetX,n=e.offsetY;Z(t,n),E=t,y=n}function D(){h=!1}function M(){h=!1}function b(e){if(e.touches.length==1){const t=e.touches[0],n=new MouseEvent("mousedown",{clientX:t.clientX,clientY:t.clientY});c.dispatchEvent(n)}e.preventDefault()}function P(e){if(e.touches.length==1){const t=e.touches[0],n=new MouseEvent("mousemove",{clientX:t.clientX,clientY:t.clientY});c.dispatchEvent(n)}e.preventDefault()}function K(e){const t=new MouseEvent("mouseup",{});c.dispatchEvent(t),e.preventDefault()}function d(){var e=window.devicePixelRatio;c.width=c.clientWidth*e,c.height=c.clientHeight*e,l.scale(e,e)}function N(){c.addEventListener("mousedown",A),c.addEventListener("mouseup",D),c.addEventListener("mousemove",O),c.addEventListener("mouseout",M),c.addEventListener("touchstart",b),c.addEventListener("touchmove",P),c.addEventListener("touchend",K)}function ee(){c.removeEventListener("mousedown",A),c.removeEventListener("mouseup",D),c.removeEventListener("mousemove",O),c.removeEventListener("mouseout",M),c.removeEventListener("touchstart",b),c.removeEventListener("touchmove",P),c.removeEventListener("touchend",K)}function v(e){return a&&clearInterval(a),a=setInterval(()=>{B(),setTimeout(k,e/2)},e),a}function te(){a&&(clearInterval(a),a=null)}function ne(){m.textContent==="Draw Off"?(ee(),m.textContent="Draw On"):(N(),m.textContent="Draw Off"),d()}function oe(){i.textContent==="Auto Off"?(te(),i.textContent="Auto x1 On"):i.textContent==="Auto x1 On"?(v(8e3),i.textContent="Auto x2 On"):i.textContent==="Auto x2 On"?(v(4e3),i.textContent="Auto x4 On"):i.textContent==="Auto x4 On"?(v(2e3),i.textContent="Auto x8 On"):i.textContent==="Auto x8 On"&&(v(1e3),i.textContent="Auto Off")}function ce(){window.history.back()}function x(){location.href="/ring-word/wordPage?nickname="+L}});
