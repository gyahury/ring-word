import"./style-B_l4csH6.js";document.addEventListener("DOMContentLoaded",()=>{const p=new URLSearchParams(window.location.search),P=p.get("nickname"),X=p.get("page"),L=document.getElementById("word"),Y=document.getElementById("curWordCount"),y=document.getElementById("allWordCount"),S=document.getElementById("prevButton"),j=document.getElementById("flipButton"),T=document.getElementById("nextButton"),z=document.getElementById("searchButton"),R=document.getElementById("toggleMenuButton"),f=document.getElementById("toggleDrawButton"),c=document.getElementById("controlAutoProgressButton"),$=document.getElementById("shuffleButton"),H=document.getElementById("excludeWordButton"),U=document.getElementById("backButton"),n=document.getElementById("canvas"),s=n.getContext("2d");let u=[],o=0,i=!0,m=!1,v=0,g=0,a;l(),W(),fetch("https://gyahury.github.io/japanese-word/"+P+"/words.json").then(t=>t.json()).then(t=>{u=t.words.filter(e=>e.type===X),y.textContent=u.length,u.length>0?d(o):(alert("invalid access"),x())}).catch(t=>alert("error occurred : "+t)),window.addEventListener("resize",l),document.addEventListener("keydown",function(t){t.key==="ArrowLeft"?(l(),k()):t.key==="ArrowRight"?(l(),h()):(t.key==="ArrowUp"||t.key==="ArrowDown")&&E()}),S.addEventListener("click",()=>{l(),k()}),T.addEventListener("click",()=>{l(),h()}),j.addEventListener("click",()=>{E()}),z.addEventListener("click",()=>{const e=`https://ja.dict.naver.com/?m=mobile#/search?query=${u[o].word}`;window.open(e,"_blank")}),R.addEventListener("click",w),f.addEventListener("click",J),c.addEventListener("click",K),H.addEventListener("click",N),$.addEventListener("click",()=>{confirm("would you like to shuffle?")&&(o=0,i=!0,l(),_(u),d(o),w())}),U.addEventListener("click",()=>{confirm("are you sure you want to go back? unsaved changes will be lost")&&x()});function d(t){const e=u[t];i?L.innerHTML=`${e.word}`:L.innerHTML=`${e.furigana}<div style='font-size: clamp(0.7rem, 6vw, 2rem);'>${e.meaning}</div>`,Y.textContent=t+1}function N(){confirm("would you like to exclude this word? it will be temporarily excluded")&&(u=u.filter((t,e)=>e!==o),u.length==0?(alert("congratulations. there are no more words to memorize"),x()):(o>=u.length&&(o=0),i=!0,d(o)),y.textContent=u.length,w())}function k(){o>0?(o--,i=!0,d(o)):o==0&&(o=u.length-1,i=!0,d(o))}function h(){o<u.length-1?(o++,i=!0,d(o)):o==u.length-1&&(o=0,i=!0,d(o))}function E(){i=!i,d(o)}function w(){const t=document.getElementById("toggleMenuButton"),e=t.parentNode.nextElementSibling,r=t.getAttribute("aria-expanded")==="true";t.setAttribute("aria-expanded",!r),e.style.display=r?"none":"block"}function _(t){for(let e=t.length-1;e>0;e--){const r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}}function q(t,e){s.beginPath(),s.moveTo(v,g),s.lineTo(t,e),s.lineWidth=3,s.lineCap="round",s.strokeStyle="RGBA(169, 169, 169, 1)",s.stroke()}function C(t){v=t.offsetX,g=t.offsetY,m=!0}function A(t){if(!m)return;let e=t.offsetX,r=t.offsetY;q(e,r),v=e,g=r}function I(){m=!1}function D(){m=!1}function M(t){if(t.touches.length==1){const e=t.touches[0],r=new MouseEvent("mousedown",{clientX:e.clientX,clientY:e.clientY});n.dispatchEvent(r)}t.preventDefault()}function b(t){if(t.touches.length==1){const e=t.touches[0],r=new MouseEvent("mousemove",{clientX:e.clientX,clientY:e.clientY});n.dispatchEvent(r)}t.preventDefault()}function O(t){const e=new MouseEvent("mouseup",{});n.dispatchEvent(e),t.preventDefault()}function l(){var t=window.devicePixelRatio;n.width=n.clientWidth*t,n.height=n.clientHeight*t,s.scale(t,t)}function W(){n.addEventListener("mousedown",C),n.addEventListener("mouseup",I),n.addEventListener("mousemove",A),n.addEventListener("mouseout",D),n.addEventListener("touchstart",M),n.addEventListener("touchmove",b),n.addEventListener("touchend",O)}function F(){n.removeEventListener("mousedown",C),n.removeEventListener("mouseup",I),n.removeEventListener("mousemove",A),n.removeEventListener("mouseout",D),n.removeEventListener("touchstart",M),n.removeEventListener("touchmove",b),n.removeEventListener("touchend",O)}function B(t){return a&&clearInterval(a),a=setInterval(()=>{E(),setTimeout(h,t/2)},t),a}function G(){a&&(clearInterval(a),a=null)}function J(){f.textContent==="Draw Off"?(F(),f.textContent="Draw On"):(W(),f.textContent="Draw Off"),l()}function K(){c.textContent==="Auto Off"?(G(),c.textContent="Auto x1 On"):c.textContent==="Auto x1 On"?(B(4e3),c.textContent="Auto x2 On"):c.textContent==="Auto x2 On"?(B(2e3),c.textContent="Auto x4 On"):c.textContent==="Auto x4 On"&&(B(1e3),c.textContent="Auto Off")}function x(){window.history.back()}});
